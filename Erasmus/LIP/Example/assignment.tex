% Options for packages loaded elsewhere
% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrartcl}
\usepackage{xcolor}
\usepackage{amsmath,amssymb}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
  \setmainfont[]{Latin Modern Roman}
  \setsansfont[]{Latin Modern Roman}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
% Make \paragraph and \subparagraph free-standing
\makeatletter
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}{
    \@ifstar
      \xxxParagraphStar
      \xxxParagraphNoStar
  }
  \newcommand{\xxxParagraphStar}[1]{\oldparagraph*{#1}\mbox{}}
  \newcommand{\xxxParagraphNoStar}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}{
    \@ifstar
      \xxxSubParagraphStar
      \xxxSubParagraphNoStar
  }
  \newcommand{\xxxSubParagraphStar}[1]{\oldsubparagraph*{#1}\mbox{}}
  \newcommand{\xxxSubParagraphNoStar}[1]{\oldsubparagraph{#1}\mbox{}}
\fi
\makeatother

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\newsavebox\pandoc@box
\newcommand*\pandocbounded[1]{% scales image to fit in text height/width
  \sbox\pandoc@box{#1}%
  \Gscale@div\@tempa{\textheight}{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
  \Gscale@div\@tempb{\linewidth}{\wd\pandoc@box}%
  \ifdim\@tempb\p@<\@tempa\p@\let\@tempa\@tempb\fi% select the smaller of both
  \ifdim\@tempa\p@<\p@\scalebox{\@tempa}{\usebox\pandoc@box}%
  \else\usebox{\pandoc@box}%
  \fi%
}
% Set default figure placement to htbp
\def\fps@figure{htbp}
\makeatother





\setlength{\emergencystretch}{3em} % prevent overfull lines

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}



 


\KOMAoption{captions}{tableheading}
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Sensitivity Analysis and Revised Simplex},
  pdfauthor={nesko25},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}


\title{Sensitivity Analysis and Revised Simplex}
\author{nesko25}
\date{}
\begin{document}
\maketitle


\section{1 - Mathematical Formulation}\label{mathematical-formulation}

Given the data, the factory-planning problem model will look like this:

\[
\begin{aligned}
\max \  & 19x_1 + 13x_2 + 12x_3 + 17x_4 \\
s.t. \ & 3x_1 + 2x_2 + x_3 + 2x_4 \le 225 \\
& x_1 + x_2 + x_3 + x_4 \le 117 \\
& 4x_1 + 3x_2 + 3x_3 + 4x_4 \le 420 \\
& x_1, x_2, x_3, x_4 \ge 0
\end{aligned}
\]

We can implement it in python and bring to the equational standard form
to get the initial tableau:

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\ImportTok{from}\NormalTok{ fractions }\ImportTok{import}\NormalTok{ Fraction}
\ImportTok{from}\NormalTok{ util }\ImportTok{import}\NormalTok{ tableau}

\NormalTok{n }\OperatorTok{=} \DecValTok{4}
\NormalTok{m }\OperatorTok{=} \DecValTok{3}

\CommentTok{\# model in standard form}
\NormalTok{A }\OperatorTok{=}\NormalTok{ np.array([}
\NormalTok{    [}\DecValTok{3}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{],}
\NormalTok{    [}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{],}
\NormalTok{    [}\DecValTok{4}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{]}
\NormalTok{])}
\NormalTok{b }\OperatorTok{=}\NormalTok{ np.array([}\DecValTok{225}\NormalTok{, }\DecValTok{117}\NormalTok{, }\DecValTok{420}\NormalTok{])}
\NormalTok{c }\OperatorTok{=}\NormalTok{ np.array([}\DecValTok{19}\NormalTok{, }\DecValTok{13}\NormalTok{, }\DecValTok{12}\NormalTok{, }\DecValTok{17}\NormalTok{])}

\CommentTok{\# equational standard form}
\NormalTok{A }\OperatorTok{=}\NormalTok{ np.hstack([A, np.identity(m)])}
\NormalTok{c }\OperatorTok{=}\NormalTok{ np.hstack([c, np.zeros(m)])}

\CommentTok{\# inital tableau}
\NormalTok{T }\OperatorTok{=}\NormalTok{ np.column\_stack([}
\NormalTok{    np.vstack([A, c]),}
\NormalTok{    np.append(np.zeros(m), [}\DecValTok{1}\NormalTok{]), }\CommentTok{\# {-}z}
\NormalTok{    np.append(b, [}\DecValTok{0}\NormalTok{]) }\CommentTok{\# b}
\NormalTok{])}

\CommentTok{\# make it pretty}
\NormalTok{T }\OperatorTok{=}\NormalTok{ np.array(T, dtype }\OperatorTok{=} \BuiltInTok{object}\NormalTok{)}
\ControlFlowTok{for}\NormalTok{ j }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(m }\OperatorTok{+} \DecValTok{1}\NormalTok{):}
    \ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(n }\OperatorTok{+}\NormalTok{ m }\OperatorTok{+} \DecValTok{2}\NormalTok{):}
\NormalTok{        T[j][i] }\OperatorTok{=}\NormalTok{ Fraction(T[j][i])}

\NormalTok{tableau(T)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
|    x1 |    x2 |    x3 |    x4 |    x5 |    x6 |    x7 |    -z |     b |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
|     3 |     2 |     1 |     2 |     1 |     0 |     0 |     0 |   225 |
|     1 |     1 |     1 |     1 |     0 |     1 |     0 |     0 |   117 |
|     4 |     3 |     3 |     4 |     0 |     0 |     1 |     0 |   420 |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
|    19 |    13 |    12 |    17 |     0 |     0 |     0 |     1 |     0 |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
\end{verbatim}

\newpage

\section{2 - Optimal Tableau}\label{optimal-tableau}

\subsection{Using Original Simplex}\label{using-original-simplex}

Choose variable to bring to the basis

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ ratio\_test():}
\NormalTok{    enter }\OperatorTok{=}\NormalTok{ np.argmax(T[}\OperatorTok{{-}}\DecValTok{1}\NormalTok{][:n }\OperatorTok{+}\NormalTok{ m]) }\CommentTok{\# index of biggest reduced cost}
    \ControlFlowTok{if}\NormalTok{ T[}\OperatorTok{{-}}\DecValTok{1}\NormalTok{][enter] }\OperatorTok{\textless{}=} \DecValTok{0}\NormalTok{:}
        \ControlFlowTok{return}\NormalTok{ [}\VariableTok{None}\NormalTok{, }\VariableTok{None}\NormalTok{] }\CommentTok{\# no positive rc {-} optimal}

\NormalTok{    ratios }\OperatorTok{=}\NormalTok{ [}
\NormalTok{        T[j][}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{/}\NormalTok{ T[j][enter] }\CommentTok{\# b term / entering column term}
        \ControlFlowTok{if}\NormalTok{ T[j][enter] }\OperatorTok{\textgreater{}} \DecValTok{0}
        \ControlFlowTok{else} \BuiltInTok{float}\NormalTok{(}\StringTok{\textquotesingle{}inf\textquotesingle{}}\NormalTok{)}
        \ControlFlowTok{for}\NormalTok{ j }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(m)}
\NormalTok{    ]}

\NormalTok{    leave }\OperatorTok{=}\NormalTok{ np.argmin(ratios) }\CommentTok{\# index of smallest ratio}
    \ControlFlowTok{if}\NormalTok{ ratios[leave] }\OperatorTok{==} \BuiltInTok{float}\NormalTok{(}\StringTok{\textquotesingle{}inf\textquotesingle{}}\NormalTok{):}
        \ControlFlowTok{return}\NormalTok{ [}\VariableTok{None}\NormalTok{, }\VariableTok{None}\NormalTok{] }\CommentTok{\# all ratio terms are \textless{}= 0 {-} unbounded}

    \ControlFlowTok{return}\NormalTok{ [enter, leave] }\CommentTok{\# indices in T}

\NormalTok{enter, leave }\OperatorTok{=}\NormalTok{ ratio\_test()}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"pivot: (}\SpecialCharTok{\{}\NormalTok{enter}\SpecialCharTok{\}}\SpecialStringTok{, }\SpecialCharTok{\{}\NormalTok{leave}\SpecialCharTok{\}}\SpecialStringTok{)"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
pivot: (0, 0)
\end{verbatim}

So according to the ratio\_test \(x_1\) should enter and \(x_5\) should
leave

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ update\_tableau(enter, leave):}
\NormalTok{    T[leave] }\OperatorTok{/=}\NormalTok{ T[leave][enter] }\CommentTok{\# normalize row to get 1 in entering col}
    \ControlFlowTok{for}\NormalTok{ j }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(m }\OperatorTok{+} \DecValTok{1}\NormalTok{):}
        \ControlFlowTok{if}\NormalTok{ j }\OperatorTok{!=}\NormalTok{ leave:}
\NormalTok{            T[j] }\OperatorTok{{-}=}\NormalTok{ T[leave] }\OperatorTok{*}\NormalTok{ T[j][enter] }\CommentTok{\# all other rows set to 0 in entering col}

\NormalTok{update\_tableau(enter, leave)}
\NormalTok{tableau(T)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
|    x1 |    x2 |    x3 |    x4 |    x5 |    x6 |    x7 |    -z |     b |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
|     1 |   2/3 |   1/3 |   2/3 |   1/3 |     0 |     0 |     0 |    75 |
|     0 |   1/3 |   2/3 |   1/3 |  -1/3 |     1 |     0 |     0 |    42 |
|     0 |   1/3 |   5/3 |   4/3 |  -4/3 |     0 |     1 |     0 |   120 |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
|     0 |   1/3 |  17/3 |  13/3 | -19/3 |     0 |     0 |     1 | -1425 |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
\end{verbatim}

And we repeat:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ pivot():}
\NormalTok{    enter, leave }\OperatorTok{=}\NormalTok{ ratio\_test()}
\NormalTok{    update\_tableau(enter, leave)}
\NormalTok{    tableau(T)}

\NormalTok{pivot()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
|    x1 |    x2 |    x3 |    x4 |    x5 |    x6 |    x7 |    -z |     b |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
|     1 |   1/2 |     0 |   1/2 |   1/2 |  -1/2 |     0 |     0 |    54 |
|     0 |   1/2 |     1 |   1/2 |  -1/2 |   3/2 |     0 |     0 |    63 |
|     0 |  -1/2 |     0 |   1/2 |  -1/2 |  -5/2 |     1 |     0 |    15 |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
|     0 |  -5/2 |     0 |   3/2 |  -7/2 | -17/2 |     0 |     1 | -1782 |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pivot()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
|    x1 |    x2 |    x3 |    x4 |    x5 |    x6 |    x7 |    -z |     b |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
|     1 |     1 |     0 |     0 |     1 |     2 |    -1 |     0 |    39 |
|     0 |     1 |     1 |     0 |     0 |     4 |    -1 |     0 |    48 |
|     0 |    -1 |     0 |     1 |    -1 |    -5 |     2 |     0 |    30 |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
|     0 |    -1 |     0 |     0 |    -2 |    -1 |    -3 |     1 | -1827 |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
\end{verbatim}

And we've reached optimality as there are no more positive reduced
costs. The solution agrees with the statement in the exercise that in
the optimal solution \(x_1\), \(x_3\) and \(x_4\) will be in basis.

\subsection{Using Revised Simplex}\label{using-revised-simplex}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{B }\OperatorTok{=}\NormalTok{ [}\DecValTok{0}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{] }\CommentTok{\# final basis}
\NormalTok{N }\OperatorTok{=}\NormalTok{ [}\DecValTok{1}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{]}

\NormalTok{A\_Binv }\OperatorTok{=}\NormalTok{ np.linalg.inv(A[:, B])}

\CommentTok{\# A and c {-} basic}
\NormalTok{T[:m, B] }\OperatorTok{=}\NormalTok{ np.identity(m)}
\NormalTok{T[}\OperatorTok{{-}}\DecValTok{1}\NormalTok{, B] }\OperatorTok{=}\NormalTok{ np.zeros(m)}

\CommentTok{\# A and c {-} nonbasic}
\NormalTok{T[:m, N] }\OperatorTok{=}\NormalTok{ A\_Binv }\OperatorTok{@}\NormalTok{ A[:, N]}
\NormalTok{T[}\OperatorTok{{-}}\DecValTok{1}\NormalTok{, N] }\OperatorTok{=}\NormalTok{ c[N] }\OperatorTok{{-}}\NormalTok{ c[B] }\OperatorTok{@}\NormalTok{ T[:m, N]}

\CommentTok{\# b and d}
\NormalTok{T[:m, }\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{=}\NormalTok{ A\_Binv }\OperatorTok{@}\NormalTok{ b}
\NormalTok{T[}\OperatorTok{{-}}\DecValTok{1}\NormalTok{, }\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{=} \OperatorTok{{-}}\NormalTok{ c[B] }\OperatorTok{@}\NormalTok{ T[:m, }\OperatorTok{{-}}\DecValTok{1}\NormalTok{]}

\CommentTok{\# make it pretty again}
\NormalTok{T }\OperatorTok{=}\NormalTok{ np.array(T, dtype }\OperatorTok{=} \BuiltInTok{object}\NormalTok{)}
\ControlFlowTok{for}\NormalTok{ j }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(m }\OperatorTok{+} \DecValTok{1}\NormalTok{):}
    \ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(n }\OperatorTok{+}\NormalTok{ m }\OperatorTok{+} \DecValTok{2}\NormalTok{):}
\NormalTok{        T[j][i] }\OperatorTok{=}\NormalTok{ Fraction(}\BuiltInTok{round}\NormalTok{(T[j][i]))}

\NormalTok{tableau(T)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
|    x1 |    x2 |    x3 |    x4 |    x5 |    x6 |    x7 |    -z |     b |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
|     1 |     1 |     0 |     0 |     1 |     2 |    -1 |     0 |    39 |
|     0 |     1 |     1 |     0 |     0 |     4 |    -1 |     0 |    48 |
|     0 |    -1 |     0 |     1 |    -1 |    -5 |     2 |     0 |    30 |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
|     0 |    -1 |     0 |     0 |    -2 |    -1 |    -3 |     1 | -1827 |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
\end{verbatim}

We achieved the exact same tableau with non-positive reduced cost
therefore we found the optimal solution - again.

\newpage

\section{3 - Reduced Cost}\label{reduced-cost}

What's the increase in price that would make \(x_2\) worth being
produced? \newline We remember that:

\[
\bar{c}_2 = c_2 - \sum_{i}{y_i a_{i2}}
\]

where \(\bar{c}_2\) is the reduced cost of \(x_2\) after last iteration.
\newline To make \(x_2\) worth producing the reduced cost should be
positive, and from the above formula we see that the increase in price
will correspond to the same increase in the reduced cost. As the reduced
cost of \(x_2\) is equal to \(-1\) after the last iteration, the
increase in price that would make \(x_2\) worth being produced is any
amount \(> 1\).

\newpage

\section{4 - Shadow Price}\label{shadow-price}

Shadow prices can be read directly from the last tableau:

\[
\begin{aligned}
2 \ & - for \ an \ hour \ of \ work \\
1 \ & - for \ a \ unit \ of \ metal \\
3 \ & - for \ a \ unit \ of \ wood
\end{aligned}
\]

\newpage

\section{5 - Complementary Slackness
Theorem}\label{complementary-slackness-theorem}

Are all the constraints binding? \newline The Complementary Slackness
Theorem implies for \(x*\) and \(y*\) - optimal solutions of the Primal
and Dual problems respectively:

\[
\forall_{j}{\ (b_j - \sum_{i}{a_{ji}x*_i})y*_j = 0}
\]

Which means that for each constraint it's either binding, or it's shadow
price is \(0\). Seeing that all of the shadow prices are non-zero
(previous subtask) we can conclude that all constraint of the Primal
problem are binding (active). \newline On a side note: We can also
observe that none of the slack variables are in basis in the optimal
solution, which means there is no slack capacity, which is yet another
way of concluding the above.

\newpage

\section{6 - Economical Interpretation}\label{economical-interpretation}

The imputed (reduced) cost of \(x_2\) is:

\[
\bar{c}_2 = c_2 - \sum_{i}{y*_i a_{i2}} = -1 < 0
\]

Which means that the cost of resources needed to produce a unit of
product \(x_2\) is significantly higher than the price of the product
itself, making it not a viable option to produce. \newline In other
words: there is slack in the \(2^{nd}\) constraint of the Dual.

\newpage

\section{7 - Increased Net Profit}\label{increased-net-profit}

As mentioned previously - the increase in the reduced cost is equal to
the increase in the original net profit. So change in desk net profit
from 13 to 15 would cause the increase in the reduced cost of \(x_2\) of
2, which is more than 1, so we will be able to do one more iteration of
the simplex and bring \(x_2\) in the basis.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{T[}\OperatorTok{{-}}\DecValTok{1}\NormalTok{][}\DecValTok{1}\NormalTok{] }\OperatorTok{+=} \DecValTok{2} \CommentTok{\# increase x2 reduced cost}
\NormalTok{tableau(T)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
|    x1 |    x2 |    x3 |    x4 |    x5 |    x6 |    x7 |    -z |     b |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
|     1 |     1 |     0 |     0 |     1 |     2 |    -1 |     0 |    39 |
|     0 |     1 |     1 |     0 |     0 |     4 |    -1 |     0 |    48 |
|     0 |    -1 |     0 |     1 |    -1 |    -5 |     2 |     0 |    30 |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
|     0 |     1 |     0 |     0 |    -2 |    -1 |    -3 |     1 | -1827 |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pivot()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
|    x1 |    x2 |    x3 |    x4 |    x5 |    x6 |    x7 |    -z |     b |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
|     1 |     1 |     0 |     0 |     1 |     2 |    -1 |     0 |    39 |
|    -1 |     0 |     1 |     0 |    -1 |     2 |     0 |     0 |     9 |
|     1 |     0 |     0 |     1 |     0 |    -3 |     1 |     0 |    69 |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
|    -1 |     0 |     0 |     0 |    -3 |    -3 |    -2 |     1 | -1866 |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
\end{verbatim}

We reach a new optimal solution with an even higher objective function.

\newpage

\section{8 - Increased Material
Availability}\label{increased-material-availability}

We need to recalculate the final b - column of the tableau.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# b and d}
\NormalTok{T[:m, }\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{=}\NormalTok{ A\_Binv }\OperatorTok{@}\NormalTok{ (b }\OperatorTok{+}\NormalTok{ [}\DecValTok{0}\NormalTok{, }\DecValTok{125} \OperatorTok{{-}} \DecValTok{117}\NormalTok{, }\DecValTok{0}\NormalTok{]) }\CommentTok{\# new b}
\NormalTok{T[}\OperatorTok{{-}}\DecValTok{1}\NormalTok{, }\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{=} \OperatorTok{{-}}\NormalTok{ c[B] }\OperatorTok{@}\NormalTok{ T[:m, }\OperatorTok{{-}}\DecValTok{1}\NormalTok{]}

\CommentTok{\# make pretty again}
\ControlFlowTok{for}\NormalTok{ j }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(m }\OperatorTok{+} \DecValTok{1}\NormalTok{):}
\NormalTok{    T[j][}\OperatorTok{{-}}\DecValTok{1}\NormalTok{] }\OperatorTok{=}\NormalTok{ Fraction(}\BuiltInTok{round}\NormalTok{(T[j][}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]))}

\NormalTok{tableau(T)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
|    x1 |    x2 |    x3 |    x4 |    x5 |    x6 |    x7 |    -z |     b |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
|     1 |     1 |     0 |     0 |     1 |     2 |    -1 |     0 |    55 |
|     0 |     1 |     1 |     0 |     0 |     4 |    -1 |     0 |    80 |
|     0 |    -1 |     0 |     1 |    -1 |    -5 |     2 |     0 |   -10 |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
|     0 |    -1 |     0 |     0 |    -2 |    -1 |    -3 |     1 | -1835 |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+
\end{verbatim}

We get an infeasible solution. We would need to apply the dual simplex
in order to retrieve feasibility.

\subsubsection{TODO: apply the dual
here?}\label{todo-apply-the-dual-here}

\newpage

\section{9 - New Product}\label{new-product}

We need to insert a new column into our tableau, calculate it for the
current iteration and check wether we should bring the new variable into
the basis or not.

\small

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{T }\OperatorTok{=}\NormalTok{ np.column\_stack([}
\NormalTok{    T[:, :n }\OperatorTok{+}\NormalTok{ m],}
\NormalTok{    np.zeros(m }\OperatorTok{+} \DecValTok{1}\NormalTok{), }\CommentTok{\# insert new column after the slacks as x8}
\NormalTok{    T[:, n }\OperatorTok{+}\NormalTok{ m:]}
\NormalTok{])}

\NormalTok{n }\OperatorTok{+=} \DecValTok{1}

\CommentTok{\# new column updated}
\NormalTok{T[:m, }\DecValTok{7}\NormalTok{] }\OperatorTok{=}\NormalTok{ A\_Binv }\OperatorTok{@}\NormalTok{ [}\DecValTok{3}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{]}
\NormalTok{T[}\OperatorTok{{-}}\DecValTok{1}\NormalTok{, }\DecValTok{7}\NormalTok{] }\OperatorTok{=} \DecValTok{14} \OperatorTok{{-}}\NormalTok{ c[B] }\OperatorTok{@}\NormalTok{ T[:m, }\DecValTok{7}\NormalTok{]}

\CommentTok{\# make pretty again}
\ControlFlowTok{for}\NormalTok{ j }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(m }\OperatorTok{+} \DecValTok{1}\NormalTok{):}
\NormalTok{    T[j][}\DecValTok{7}\NormalTok{] }\OperatorTok{=}\NormalTok{ Fraction(}\BuiltInTok{round}\NormalTok{(T[j][}\DecValTok{7}\NormalTok{]))}

\NormalTok{tableau(T)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
|-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|    x1 |    x2 |    x3 |    x4 |    x5 |    x6 |    x7 |    x8 |    -z |     b |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|     1 |     1 |     0 |     0 |     1 |     2 |    -1 |     3 |     0 |    39 |
|     0 |     1 |     1 |     0 |     0 |     4 |    -1 |     2 |     0 |    48 |
|     0 |    -1 |     0 |     1 |    -1 |    -5 |     2 |    -4 |     0 |    30 |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|     0 |    -1 |     0 |     0 |    -2 |    -1 |    -3 |     1 |     1 | -1827 |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
\end{verbatim}

\normalsize

We observe that new variable's reduced cost is positive.

\small

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pivot()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
|-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|    x1 |    x2 |    x3 |    x4 |    x5 |    x6 |    x7 |    x8 |    -z |     b |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|   1/3 |   1/3 |     0 |     0 |   1/3 |   2/3 |  -1/3 |     1 |     0 |    13 |
|  -2/3 |   1/3 |     1 |     0 |  -2/3 |   8/3 |  -1/3 |     0 |     0 |    22 |
|   4/3 |   1/3 |     0 |     1 |   1/3 |  -7/3 |   2/3 |     0 |     0 |    82 |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|  -1/3 |  -4/3 |     0 |     0 |  -7/3 |  -5/3 |  -8/3 |     0 |     1 | -1840 |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
\end{verbatim}

\normalsize

Turns out coffee tables are worth producing.

\newpage

\section{10 - New Constraint}\label{new-constraint}

We need to introduce a new row, but also a new slack column. The new
constraint is: \[
x_3 \le 5x_2 \implies 0x_1 - 5x_2 + x_3 + 0x_4 \le 0
\]

Since each Simplex iteration is just elementary row operations, we can
simply add the new constraint to the final tableau without having to
recalculate anything.

\small

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{T }\OperatorTok{=}\NormalTok{ np.column\_stack([}
\NormalTok{    T[:, :n }\OperatorTok{+}\NormalTok{ m],}
\NormalTok{    np.zeros(m }\OperatorTok{+} \DecValTok{1}\NormalTok{), }\CommentTok{\# new slack}
\NormalTok{    T[:, n }\OperatorTok{+}\NormalTok{ m:]}
\NormalTok{])}

\NormalTok{T }\OperatorTok{=}\NormalTok{ np.vstack([}
\NormalTok{    T[:m, :],}
\NormalTok{    [}\DecValTok{0}\NormalTok{, }\OperatorTok{{-}}\DecValTok{5}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{], }\CommentTok{\# new constraint}
\NormalTok{    T[}\OperatorTok{{-}}\DecValTok{1}\NormalTok{, :]}
\NormalTok{])}

\NormalTok{m }\OperatorTok{+=} \DecValTok{1}

\CommentTok{\# make pretty again}
\ControlFlowTok{for}\NormalTok{ j }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(m }\OperatorTok{+} \DecValTok{1}\NormalTok{):}
\NormalTok{    T[j][}\DecValTok{7}\NormalTok{] }\OperatorTok{=}\NormalTok{ Fraction(T[j][}\DecValTok{7}\NormalTok{])}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(n }\OperatorTok{+}\NormalTok{ m }\OperatorTok{+} \DecValTok{2}\NormalTok{):}
\NormalTok{    T[}\DecValTok{3}\NormalTok{][i] }\OperatorTok{=}\NormalTok{ Fraction(T[}\DecValTok{3}\NormalTok{][i])}

\NormalTok{tableau(T)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
|-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|    x1 |    x2 |    x3 |    x4 |    x5 |    x6 |    x7 |    x8 |    -z |     b |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|     1 |     1 |     0 |     0 |     1 |     2 |    -1 |     0 |     0 |    39 |
|     0 |     1 |     1 |     0 |     0 |     4 |    -1 |     0 |     0 |    48 |
|     0 |    -1 |     0 |     1 |    -1 |    -5 |     2 |     0 |     0 |    30 |
|     0 |    -5 |     1 |     0 |     0 |     0 |     0 |     1 |     0 |     0 |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|     0 |    -1 |     0 |     0 |    -2 |    -1 |    -3 |     0 |     1 | -1827 |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
\end{verbatim}

\normalsize

Now we just need to bring the tableau into the canonical form. We can
already make some assumpions about what will happen after we do that. In
current solution we aren't producing any desks, because they're less
valuable than chairs. So after we introduce the new constraint on chair
production their production will have to go down - or the desk
production will have to go up instead of something more valuable. Either
way we expect a loss in our income, which means the solution that we
have right now will become infeasible.

\small

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{update\_tableau(}\DecValTok{2}\NormalTok{, }\DecValTok{1}\NormalTok{) }\CommentTok{\# pivot of the column that breaks the canonical form}
\NormalTok{tableau(T)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
|-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|    x1 |    x2 |    x3 |    x4 |    x5 |    x6 |    x7 |    x8 |    -z |     b |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|     1 |     1 |     0 |     0 |     1 |     2 |    -1 |     0 |     0 |    39 |
|     0 |     1 |     1 |     0 |     0 |     4 |    -1 |     0 |     0 |    48 |
|     0 |    -1 |     0 |     1 |    -1 |    -5 |     2 |     0 |     0 |    30 |
|     0 |    -6 |     0 |     0 |     0 |    -4 |     1 |     1 |     0 |   -48 |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|     0 |    -1 |     0 |     0 |    -2 |    -1 |    -3 |     0 |     1 | -1827 |
|-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
\end{verbatim}

\normalsize

As expected - we reached the canonical form and our solution became
infeasible. Similarly as with increasing material availability - we
would have to apply the dual simplex.




\end{document}
